<div class="alert alert-info" *ngIf="adminAccess">You have admin access for this course</div>

<div class="jumbotron jumbotron" *ngIf="course">
  <h1 class="display-4">{{ course.name }} ({{ course.id }})</h1>
  <p class="lead">Welcome to the "{{ course.name }}" ({{ course.id }}) course page. Good luck in your exams!</p>
  <p class="lead">
    <button role="button" class="btn btn-info m-1" data-toggle="modal" data-target="#createTopicModal">
      <fa name="plus" class="mr-1"></fa>
      Add Topic
    </button>
    <a class="btn btn-primary m-1" [attr.href]="'https://www.facebook.com/search/groups/?q=' + course.id" target="_blank">Facebook Group</a>
    <a *ngIf="course.id.toString().startsWith('23')" class="btn btn-secondary m-1" [attr.href]="'https://webcourse.cs.technion.ac.il/'+ course.id" target="_blank">Webcourse</a>
  </p>
</div>


<div class="list-group my-3" *ngIf="topics$ | async as topics">
  <div class="list-group-item list-group-item-info">
    <fa name="comment" class="mr-2"></fa>
    Forum
    <span class="badge badge-info">{{topics.length}}</span>
  </div>
  <a routerLink="/topic/{{ topic.id }}" class="list-group-item list-group-item-action" *ngFor="let topic of topics.slice(0, topicsLimit);">
    {{ topic.subject }}
    <span class="float-right col-4">
      <app-facebook-profile-picture [fbUid]="topic.creator.fbId" [width]="30" [height]="30" class="mr-2"></app-facebook-profile-picture>
      <small class="mr-2">{{ topic.creator.name }}</small>
      <small class="float-right">{{ topic.created.toDate() | date: 'dd/MM/yyyy HH:mm' }}</small>
    </span>
  </a>
  <p>
    <button *ngIf="topicsLimit < topics.length" type="button" class="btn btn-link" (click)="topicsLimit = min(topics.length, topicsLimit + 10);">See More</button>
    <button *ngIf="topicsLimit < topics.length" type="button" class="btn btn-link" (click)="topicsLimit = topics.length;">See All</button>
    <button *ngIf="topicsLimit > 0" type="button" class="btn btn-link float-right" (click)="topicsLimit = max(0, topicsLimit - 10);">See Less</button>
    <button *ngIf="topicsLimit > 0" type="button" class="btn btn-link float-right" (click)="topicsLimit = 0;">Hide All</button>
  </p>
</div>
<div class="modal fade" id="createTopicModal" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Create new topic</h2>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <app-create-topic [linkedCourseId]="id"></app-create-topic>
      </div>
    </div>
  </div>
</div>

<div class="list-group my-3" *ngIf="exams">
  <div class="list-group-item list-group-item-primary">
    <fa name="book"></fa>
    Available exams
    <span class="badge badge-primary">{{exams.length}}</span>
  </div>
  <a *ngFor="let e of exams.slice(0, examsLimit)" routerLink="exam/{{ e.id }}" class="list-group-item list-group-item-action">
    {{e.semester | titlecase}} {{ e.year }} - Moed {{e.moed}}
  </a>
  <p>
    <button *ngIf="examsLimit < exams.length" type="button" class="btn btn-link" (click)="examsLimit = min(exams.length, examsLimit + 10);">See More</button>
    <button *ngIf="examsLimit < exams.length" type="button" class="btn btn-link" (click)="examsLimit = exams.length;">See All</button>
    <button *ngIf="examsLimit > 0" type="button" class="btn btn-link float-right" (click)="examsLimit = max(0, examsLimit - 10);">See Less</button>
    <button *ngIf="examsLimit > 0" type="button" class="btn btn-link float-right" (click)="examsLimit = 0;">Hide All</button>
  </p>
</div>

<div class="list-group my-3" *ngIf="questions">
  <div class="list-group-item list-group-item-danger">
    <fa name="fire"></fa>
    Hot questions
    <span class="badge badge-danger">{{questions.length}}</span>
  </div>
  <a routerLink="/question/{{ q.id }}" class="list-group-item list-group-item-action" *ngFor="let q of questions.slice(0, questionsLimit)">
    {{ q.semester | titlecase}} {{ q.year }} - Moed {{ q.moed | titlecase}}: Question {{ q.number }}
  </a>
  <p>
    <button *ngIf="questionsLimit < questions.length" type="button" class="btn btn-link" (click)="questionsLimit = min(questions.length, questionsLimit + 10);">See More</button>
    <button *ngIf="questionsLimit < questions.length" type="button" class="btn btn-link" (click)="questionsLimit = questions.length;">See All</button>
    <button *ngIf="questionsLimit > 0" type="button" class="btn btn-link float-right" (click)="questionsLimit = max(0, questionsLimit - 10);">See Less</button>
    <button *ngIf="questionsLimit > 0" type="button" class="btn btn-link float-right" (click)="questionsLimit = 0;">Hide All</button>
  </p>
</div>
